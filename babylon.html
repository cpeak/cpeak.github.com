---
layout: dark
permalink: /babylon/
---
<div class="blog-post">
  <header class="blog-post__header">
    <h1 class="blog-post__title">Babylon + Craft CMS <span class="blog-post__meta">June 12, 2018</span></h1>
  </header>

  <article class="blog-post__content">
    <h2>Introduction</h2>
    <p>The Babylon Marketing site currently uses CraftCMS v2 enabling the team to create and update pages without additional dev help. Documentation for Craft v2 can be found <a href="https://docs.craftcms.com/v2/" target="blank">here</a>.</p>
    <p>The power of Craft is that it is extremely flexible and completely controlled by the user. The downside is that it's not a site builder or design tool. Everything has to be created by the user.</p>
    <h2>Learning Curve</h2>
    <p>One challenge with working in Craft is that there is a pretty steep learning curve. The basics of the system don't really make sense at first. You don't create pages, you create sections that are either Singles, Channels, or Structures. You also have to get used to the fact you have to create the data structure for each module, then allow which of those each page has access to.</p>
    <p>I like to think along the lines of Lego - you create the pieces, then on each Section (page) you must define which pieces you can use, and only then can you actually create the page. There's a lot of little frustrating things that need some explanation, which I will try to do here. This document is part documentation, part "wish I would have known when I started".</p>
    <h2>Sections and Entries and Fields, Oh My!</h2>
    <p>One of the hardest things to get under your belt is the fact that there aren't "Pages" that you create. You first setup a Section. As mentioned earlier a Section can be either a Single, Channel, or Structure. Most of the pages on the site are going to be Singles.</p>
    <h3>Single</h3>
    <p>These are single pages of unique content. Most of the site is going to be single entries.</p>
    <h3>Channel</h3>
    <p>Channel pages are "streams of similar content" such as a Blog, News articles, or something along those lines. These all use the same template structure and are typically too rigid for this particular instance.</p>
    <h3>Structure</h3>
    <p>Structures are for multiple similar entries that need to be in a specific order such as Documentation or an Organization Chart. I have not seen this used in a real world application yet.</p>
    <h2>Neo Plugin & Main2</h2>
    <p>One "gotcha" specifically in this project is that the data structure is completely based on the <a href="https://github.com/benjamminf/craft-neo" target="blank">Neo Plugin</a> which allows nesting of matrix fields in entries. This gives us much more freedom to create complex pieces to use on each page, however it also means the entire system is now dependent on one developer who as of writing this, has not updated the plugin to Craft 3.</p>
    <h2>Lets create a page</h2>
    <p>Creating a new page requires a few steps. First go into <code>Settings &gt; Sections</code> and click New Section at the top.</p>
    <img src="/images/babylon/new-section.jpg" />
    <p>Enter the page title, and be sure to enter <code>default</code> into the Entry Template section at the bottom. That is the HTML template that CraftCMS will look for when rendering the page. The HTML template is located in <code>/craft/templates/default.html</code>. Now that your Section is created we need to tell it which Fields you can use. Still in <code>Settings &gt; Sections</code> find the new Section and click <code>Edit entry type</code> on the right hand side.</p>
    <img src="/images/babylon/section-fields.jpg" />
    <p>Create a new Tab (its ridiculous that if you don't you can't drag a block up and create one), then scroll down and find Main2 in Default column. Main2 is where most of the content structure is setup such as the 50/50 module, the Content-Section module, the CTAs, and so on...</p>
    <p>Okay, now that the Section is setup, its time to create the Entry. The Section is kind of like the container, the Entry is what we fill it with. So in the Admin control panel click <code>Entries</code> then select <code>Singles</code>, and find the Section you just created. You'll see that you can now select any block that is available to Main2. To get things rolling, lets make a Content Section block.</p>
    <img src="/images/babylon/first-block.jpg" />
    <p>Sidebar: There are a lot of blocks that aren't used, or aren't named the best that need to be refactored or weeded out at some point. For example most pages start with a big hero message, so naturally you would assume you would select Hero, or Hero-slider under the Header tab - this is incorrect. Most pages use a Content-Section with the Appearance set to Hero. This will be a maintenance issue moving forwards. Anyway, onwards.</p>
    <p>When learning the system I found two things extremely helpful. One - look at how other pages are structured to get a sense of how each block appears. Two - <strong>Live Preview</strong> is your friend. Click it and you can make your changes and see them live on the right hand side as you change things around.</p>
    <img src="/images/babylon/live-preview.jpg" />
    <p>Play with each option and see what works, and what doesn't. As the system grows more options will crop up, but if we aren't vigilant, inconsistencies and tech debt will accumulate.</p>
    <img src="/images/babylon/content-section-options.jpg" />
    <p>You can keep adding blocks to build out a page. It's pretty straight forward once you get a good idea of which blocks are used where, there aren't too many.</p>
    <h2>Under the hood</h2>
    <p>Okay, lets pop the hood and see how the underlying structure is setup. How does Craft know how to pull up templates and fill them in with the content users provide? It takes the block Handle from the CMS and runs it through a case statement in <code>/craft/templates/core/main.html</code>. This way our Fifty Fifty block with the Handle <code>fiftyFifty</code> tells the system to render using the <code>core/main2/fifty_fifty.html</code>.</p>
    <img src="/images/babylon/case-statement.jpg" />
    <h2>Case Study - New Page &amp; Content</h2>
    <p>Okay, so we had to create a new Press Centre page to contain tile links. First step was to figure out the data we needed to input, then go into the Main2 Neo field and create a Press Centre Entries block that would contain the Press Centre Entry children. Each Press Centre Entry contains a mix of old fields recycled (preferred) and new fields specifically needed for the tiles.</p>
    <p>Background Colour and Image are globals used across different blocks. We created new fields specific to the tiles, then populated the tabs to expose them to the CMS.</p>
    <img src="/images/babylon/press-centre-entries.jpg" />
    <p>We created the Section in the Settings side of things, then went into the entry itself. You can see the Press Centre Entries block <i>contains</i> Press Centre Entry blocks. The user can keep adding as many as needed (you can limit the number of children in the CMS).</p>
    <img src="/images/babylon/press-centre-entries-cms.jpg" />
    <p>After everything is set locally we need to migrate to Staging for approval.</p>
    <h2>Navigation &amp; Globals</h2>
    <p>I was sure to build the Footer and Subnav components to be completely controlled through the CMS and nothing is hard coded. All links and data are populated through the Globals tab. Globals are pieces and variables used across all or most pages.</p>
    <img src="/images/babylon/globals.jpg" />
    <h2>Migrating and Deploying</h2>
    <p>Unfortunately migrating to Staging/Production cannot be done automatically (to the best of my knowledge). Due to the system being built on top of the Main2 Neo structure, automatic migrations aren't possible (I was informed). So as you create new fields and blocks, please document them along the way. Once everything is setup locally, repeat the steps in Staging then push the HTML structure updates to master, deploy, and create the test page on Staging. Rinse and repeat for Production.</p>
    <h2>Troubleshooting</h2>
  </article>
</div>
